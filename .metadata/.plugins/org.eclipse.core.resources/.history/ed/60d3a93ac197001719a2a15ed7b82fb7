package l03.controller;

import java.io.File;
import java.io.PrintStream;

import org.apache.pdfbox.pdmodel.PDDocument;

import technology.tabula.ObjectExtractor;
import technology.tabula.Page;
import technology.tabula.Table;
import technology.tabula.extractors.BasicExtractionAlgorithm;
import technology.tabula.writers.CSVWriter;

public class TabulaController {

	public static void main(String[] args) {
		ObjectExtractor oe = null;
        try {
            PDDocument document = PDDocument.load(new File("src/teste/resources/indictb1h_14.pdf"));
            oe = new ObjectExtractor(document);
            Page page = oe.extract(1);//numero da pagina que vai extrair
            //page.getArea();
            
           
            BasicExtractionAlgorithm bea = new BasicExtractionAlgorithm();
            Table table = bea.extract(page.getArea(205.0f, 120.0f, 622.82f, 459.9f)).get(0);
            
            CSVWriter pp = new CSVWriter();
            pp.write(new PrintStream("arquivo.csv"), table);
            oe.close();
        }catch (Exception e) {
        		e.printStackTrace();
        }
}
	}